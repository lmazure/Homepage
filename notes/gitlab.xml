<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="../css/strict.xsl"?>
<PAGE xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../css/schema.xsd" xml:lang="en">
<TITLE>GitLab</TITLE>
<PATH>notes/gitlab.xml</PATH>
<DATE><YEAR>2022</YEAR><MONTH>12</MONTH><DAY>21</DAY></DATE>
<CONTENT>
<BLIST><TITLE>Shortcuts</TITLE>
  <ITEM>Global shortcuts
    <DEFINITIONTABLE>
      <ROW>
        <TERM><MODIFIERKEY id="Shift"/><KEY id=","/></TERM>
        <DESC>Display keyboard shortcuts</DESC>
      </ROW>
      <ROW>
        <TERM><MODIFIERKEY id="Shift"/><KEY id="P"/></TERM>
        <DESC>Go to project dashboard</DESC>
      </ROW>
      <ROW>
        <TERM><MODIFIERKEY id="Shift"/><KEY id="G"/></TERM>
        <DESC>Go to group dashboard</DESC>
      </ROW>
      <ROW>
        <TERM><MODIFIERKEY id="Shift"/><KEY id="L"/></TERM>
        <DESC>Go to milestone dashboard</DESC>
      </ROW>
      <ROW>
        <TERM><MODIFIERKEY id="Shift"/><KEY id="I"/></TERM>
        <DESC>Go to issue dashboard (it displays by default the issues assigned to the current user)</DESC>
      </ROW>
      <ROW>
        <TERM><MODIFIERKEY id="Shift"/><KEY id="T"/></TERM>
        <DESC>Go to todo dashboard</DESC>
      </ROW>
      <ROW>
        <TERM><MODIFIERKEY id="Shift"/><KEY id=":"/><BR/>
          <KEY id="S"/></TERM>
        <DESC>Search</DESC>
      </ROW>
    </DEFINITIONTABLE>
  </ITEM>
  <ITEM>Project shortcuts
    <DEFINITIONTABLE>
      <ROW>
        <TERM><KEY id="G"/><KEY id="P"/></TERM>
        <DESC>Go to project overview</DESC>
      </ROW>
      <ROW>
        <TERM><KEY id="G"/><KEY id="I"/></TERM>
        <DESC>Go to issues</DESC>
      </ROW>
      <ROW>
        <TERM><KEY id="I"/></TERM>
        <DESC>Create a new issue</DESC>
      </ROW>
      <ROW>
        <TERM><KEY id="G"/><KEY id="M"/></TERM>
        <DESC>Go to merge requests</DESC>
      </ROW>
      <ROW>
        <TERM><KEY id="G"/><KEY id="N"/></TERM>
        <DESC>Go to repository graph</DESC>
      </ROW>
      <ROW>
        <TERM><KEY id="G"/><KEY id="D"/></TERM>
        <DESC>Go to repository analytics</DESC>
      </ROW>
      <ROW>
        <TERM><KEY id="G"/><KEY id="W"/></TERM>
        <DESC>Go to wiki</DESC>
      </ROW>
    </DEFINITIONTABLE>
  </ITEM>
</BLIST>
<BLIST><TITLE>Markdown</TITLE>
  <ITEM>use <CODEROUTINE>````</CODEROUTINE> to be able to write suggestions containing markdown
    <CODESAMPLE>````suggestion:-0+2<BR/>
      ```shell<BR/>
      git log<BR/>
      ```<BR/>
      ````</CODESAMPLE>
  </ITEM>
  <ITEM>Create a sortable and filterable table
    <CODESAMPLE>```json:table<BR/>
      {<BR/>
      "fields" : [<BR/>
      <TAB/><TAB/>{ "key": "client", "label": "Client", "sortable": "true" },<BR/>
      <TAB/><TAB/>{ "key": "techno", "label": "Technology", "sortable": "true" }<BR/>
      <TAB/>],<BR/>
      "items" : [<BR/>
      <TAB/><TAB/>{ "client": "Acme", "techno": "Cucumber" },<BR/>
      <TAB/><TAB/>{ "client": "Fuzzy", "techno": "Agilitest" },<BR/>
      <TAB/><TAB/>{ "client": "Knock-Knock", "techno": "Agilitest" },<BR/>
      <TAB/><TAB/>{ "client": "Opale", "techno": "Robot Framework" },<BR/>
      <TAB/><TAB/>{ "client": "Snurf", "techno": "Postman" },<BR/>
      <TAB/><TAB/>{ "client": "YAC", "techno": "Katalon" }<BR/>
      <TAB/>],<BR/>
      "filter": "true"<BR/>
      }<BR/>
      ```</CODESAMPLE>
  </ITEM>
</BLIST>
<BLIST>
  <ITEM>delete the local branches that to do not exist anymore in GitLab
    <CODESAMPLE>git checkout main<BR/>
    git fetch -p<BR/>
    git branch -vv | grep ': gone]' | awk '{print $1}' | xargs -n 1 -pr git branch -D</CODESAMPLE>
  </ITEM>
  <ITEM>run the GitLab runner in Docker
    <CODESAMPLE>docker run --rm -t -i -v C:\gitlab-runner\config:/etc/gitlab-runner gitlab/gitlab-runner register --non-interactive --executor "docker" --docker-image alpine:latest --url "https://gitlab.com/" --registration-token "XXXXXXXXXXXXXXXXXXXX" --description "myrunner" --run-untagged="true" –locked="false"<BR/>
      docker run -d --name gitlab-runner --restart always -v C:\gitlab-runner\config:/etc/gitlab-runner -v /var/run/docker.sock:/var/run/docker.sock gitlab/gitlab-runner:latest</CODESAMPLE>
    where <CODEROUTINE>XXXXXXXXXXXXXXXXXXXX</CODEROUTINE> is the registration token for specific runners<BR/>
    <CODEFILENAME>C:\gitlab-runner\config</CODEFILENAME> will be created
  </ITEM>
  <ITEM>get the audit of group https://gitlab.com/henixdevelopment
    <CODESAMPLE>curl --header "PRIVATE-TOKEN: &lt;token&gt;" https://gitlab.com/api/v4/groups/13404279/audit_events?per_page=500&amp;page=1</CODESAMPLE>
    get the audit of project https://gitlab.com/henixdevelopment/open-source/opentestfactory/orchestrator
    <CODESAMPLE>curl --header "PRIVATE-TOKEN: &lt;token&gt;" https://gitlab.com/api/v4/projects/27352872/audit_events?per_page=500&amp;page=1</CODESAMPLE>
  </ITEM>
  <ITEM>
    <BLIST><TITLE>Sorting a package in the registry with Maven</TITLE>
      <ITEM>configure the repository in <CODEFILENAME>pom.xml</CODEFILENAME>
        <CODESAMPLE>&lt;repositories&gt;<BR/>
          <TAB/>&lt;repository&gt;<BR/>
          <TAB/><TAB/>&lt;id&gt;gitlab-maven&lt;/id&gt;<BR/>
          <TAB/><TAB/>&lt;url&gt;https://gitlab.com/api/v4/projects/${env.CI_PROJECT_ID}/packages/maven&lt;/url&gt;<BR/>
          <TAB/>&lt;/repository&gt;<BR/>
          &lt;/repositories&gt;<BR/>
          &lt;distributionManagement&gt;<BR/>
          <TAB/>&lt;repository&gt;<BR/>
          <TAB/><TAB/>&lt;id&gt;gitlab-maven&lt;/id&gt;<BR/>
          <TAB/><TAB/>&lt;url&gt;https://gitlab.com/api/v4/projects/${env.CI_PROJECT_ID}/packages/maven&lt;/url&gt;<BR/>
          <TAB/>&lt;/repository&gt;<BR/>
          <TAB/>&lt;snapshotRepository&gt;<BR/>
          <TAB/><TAB/>&lt;id&gt;gitlab-maven&lt;/id&gt;<BR/>
          <TAB/><TAB/>&lt;url&gt;https://gitlab.com/api/v4/projects/${env.CI_PROJECT_ID}/packages/maven&lt;/url&gt;<BR/>
          <TAB/>&lt;/snapshotRepository&gt;<BR/>
          &lt;/distributionManagement&gt;</CODESAMPLE>
      </ITEM>
      <ITEM>declare the repository in <CODEFILENAME>setting.xml</CODEFILENAME>
        <CODESAMPLE>&lt;settings&gt;<BR/>
          <TAB/>&lt;servers&gt;<BR/>
          <TAB/><TAB/>&lt;server&gt;<BR/>
          <TAB/><TAB/><TAB/>&lt;id&gt;gitlab-maven&lt;/id&gt;<BR/>
          <TAB/><TAB/><TAB/>&lt;configuration&gt;<BR/>
          <TAB/><TAB/><TAB/><TAB/>&lt;httpHeaders&gt;<BR/>
          <TAB/><TAB/><TAB/><TAB/><TAB/>&lt;property&gt;<BR/>
          <TAB/><TAB/><TAB/><TAB/><TAB/><TAB/>&lt;name&gt;Job-Token&lt;/name&gt;<BR/>
          <TAB/><TAB/><TAB/><TAB/><TAB/><TAB/>&lt;value&gt;${CI_JOB_TOKEN}&lt;/value&gt;<BR/>
          <TAB/><TAB/><TAB/><TAB/><TAB/>&lt;/property&gt;<BR/>
          <TAB/><TAB/><TAB/><TAB/>&lt;/httpHeaders&gt;<BR/>
          <TAB/><TAB/><TAB/>&lt;/configuration&gt;<BR/>
          <TAB/><TAB/>&lt;/server&gt;<BR/>
          <TAB/>&lt;/servers&gt;<BR/>
          &lt;/settings&gt;</CODESAMPLE>
      </ITEM>
      <ITEM>configure the deploiement in <CODEFILENAME>.gitlab-ci.yml</CODEFILENAME>
        <CODESAMPLE>variables:<BR/>
          <TAB/>MAVEN_CLI_OPTS: "--batch-mode --settings settings.xml"<BR/>
          <TAB/>MAVEN_OPTS: "-Dmaven.repo.local=.m2/repository"<BR/>
          <BR/>
          cache:<BR/>
          <TAB/>paths:<BR/>
          <TAB/><TAB/>- .m2/repository/<BR/>
          …<BR/>
          package:<BR/>
          <TAB/>stage: package<BR/>
          <TAB/>script:<BR/>
          <TAB/><TAB/>- mvn $MAVEN_CLI_OPTS -Dmaven.test.skip compile assembly:single deploy</CODESAMPLE></ITEM>
    </BLIST>
  </ITEM>
</BLIST>
</CONTENT>
<X><T>links</T><A>../links/cloudforges.xml#gitlab</A><L>en</L><F>HTML</F></X>
</PAGE>