<html>
<!--
There is no license,  no copyright on this stuff (I assume this is just common
JavaScript knowledge). You can copy, modify or do whatever you want with this.
The only point is that I am not reponsible for any problem you may experience
with the quick 'n dirty code.
L. Mazure
-->
<header>
<style type="text/css">.f{position:absolute;top:0;left:0}</style>
</header>
<body>
<SCRIPT LANGUAGE="javascript1.2">

// --------------------------------------------------------------------------

Layer.width = function() {
  if (this.app._ns) {
    return this.layer.clip.width;
  }
  else if (this.app._ie) {
    return this.layer.scrollWidth;
  }
}

Layer.height = function() {
  if (this.app._ns) {
    return this.layer.clip.height;
  }
  else if (this.app._ie) {
    return this.layer.scrollHeight;
  }
}

Layer.show = function() {
  if (this.app._ns) {
    this.layer.visibility = "show";
  }
  else if (this.app._ie) {
    this.layer.style.visibility = "visible";
  }
}

Layer.hide = function() {
  if (this.app._ns) {
    this.layer.visibility = "hide";
  }
  else if (this.app._ie) {
    this.layer.style.visibility = "hidden";
  }
}

Layer.move = function(x,y) {
  if (this.app._ns) {
    this.layer.pageX=x;
    this.layer.pageY=y;
  }
  else if (this.app._ie) {
    this.layer.style.pixelLeft=x;
    this.layer.style.pixelTop=y;
  }
}

Layer.clip = function(left,right,top,bottom) {
  if (this.app._ns) {
    this.layer.clip.left = left;
    this.layer.clip.right = right;
    this.layer.clip.top = top;
    this.layer.clip.bottom = bottom;
  }
  else if (this.app._ie) {
    this.layer.style.clip = "rect("+top+"px "+right+"px "+bottom+"px "+left+"px)";
  }
}

function Layer(app,htmlCode) {
  var id="layer_"+Layer.incr;
  document.write('<DIV ID="'+id+'" class="f">'+htmlCode+'</DIV>');
  if (app._ns) {
    this.layer = document.layers[id];
  } else if (app._ie) {
    this.layer = document.all[id];
  }
  Layer.incr++;
  this.app = app;
  this.width = Layer.width;
  this.height = Layer.height;
  this.show = Layer.show;
  this.hide = Layer.hide;
  this.move = Layer.move;
  this.clip = Layer.clip;
  this.hide();
}

Layer.incr=1;

// --------------------------------------------------------------------------

Node.show = function() {
  this.layer.show();
}

Node.redraw = function() {
  this.layer.move(this.x,this.y);
}

Node.update = function(incr) {
  var width = this.layer.width();
  var height = this.layer.height();
  var t = (incr-60)/60;
  var t2 = t*t;
  var nr = this.initR*(t*t2-2*t2+2)*t;
  var na = this.initA + Math.PI*incr/20;
  ncx = this.app.windowWidth*(1+nr*Math.cos(na))/2;
  ncy = this.app.windowHeight*(1+nr*Math.sin(na))/2;
  this.x = ncx - this.offsetX;
  this.y = ncy - this.offsetY;
}

Node.isInWindow = function () {
  return !( (this.x+this.offsetX-this.width/2>this.app.windowWidth) ||
            (this.x+this.offsetX+this.width/2<0) ||
            (this.y+this.offsetY-this.height/2>this.app.windowHeight) ||
            (this.y+this.offsetY+this.height/2<0) )
}

function Node(app,htmlCode,x,y,maxX,maxY) {
  this.layer = new Layer(app,htmlCode);
  this.app = app;
  //this.layer.zIndex = x*maxY+y;
  this.width = this.layer.width();
  this.height = this.layer.height();
  var left = this.width*x/maxX;
  var right = this.width*(x+1)/maxX;
  var top = this.height*y/maxY;
  var bottom = this.height*(y+1)/maxY;
  this.layer.clip(left,right,top,bottom);
  this.x = (app.windowWidth-this.width)/2;
  this.y = (app.windowHeight-this.height)/2;
  this.layer.move(this.x,this.y);
  this.offsetX=(left+right)/2;
  this.offsetY=(bottom+top)/2;
  var cx = this.x + this.offsetX;
  var cy = this.y + this.offsetY;
  var xx = (2*cx - app.windowWidth) / app.windowWidth;
  var yy = (2*cy - app.windowHeight) / app.windowHeight;
  this.initR = Math.sqrt(xx*xx+yy*yy);
  this.initA = Math.atan2(yy/this.initR,xx/this.initR);
  this.show = Node.show;
  this.redraw = Node.redraw;
  this.update = Node.update;
  this.isInWindow = Node.isInWindow;
}

// --------------------------------------------------------------------------

NodeList.add = function(node) {
  this.nodes[this.nodes.length]=node;
}

NodeList.remove = function(node) {
  for (var i=0; i<this.nodes.length; i++) {
    if (this.nodes[i]==node) {
      for (var j=i+1; j<this.nodes.length; j++) {
         this.nodes[j-1]=this.nodes[j];
      }
      this.nodes.length--;
      return;
    }
  }
  alert("NodeList.remove: node not found");
}

NodeList.show = function() {
  for (var i=0; i<this.nodes.length; i++) {
    this.nodes[i].show();
  }
}

NodeList.redraw = function() {
  for (var i=0; i<this.nodes.length; i++) {
    this.nodes[i].redraw();
  }
}

NodeList.update = function() {
  for (var i=0; i<this.nodes.length; i++) {
    var n = this.nodes[i];
    n.update(this.incr);
    if ( !n.isInWindow() ) {
       this.remove(n);
    }
  }
  this.incr++;
}

function NodeList(app) {
  this.nodes = new Array();
  this.incr = 0;
  this.app = app;
  this.add = NodeList.add;
  this.remove = NodeList.remove;
  this.redraw = NodeList.redraw;
  this.show = NodeList.show;
  this.update = NodeList.update;
}

// --------------------------------------------------------------------------

function Application() {
  this._ns = this._ie = false;
  if (document.layers) {
    this._ns = true;
    this.windowWidth = window.innerWidth;
    this.windowHeight = window.innerHeight;
  } else if (document.all ) {
    this._ie = true;
    this.windowWidth = window.document.body.offsetWidth;
    this.windowHeight = window.document.body.offsetHeight;
  } else {
    alert("Oops! Sorry; your brower is not supported.\n"+
          "Just tell me about this, I'm be enough courageous to fix that.\n"+
          "Laurent");
  }
}

// --------------------------------------------------------------------------

function go(nodes) {
  nodes.update()
  nodes.redraw();
  if ( nodes.nodes.length>0 ) {
    setTimeout("window.go(window.nodes)",50);
  }
}

var appli = new Application();
var nodes = new NodeList(appli);
for (var x=0; x<6; x++) {
  for (var y=0; y<6; y++ ) {
    //nodes.add(new Node(appli,"<IMG SRC='bouquet.jpg'>",x,y,6,6));
    nodes.add(new Node(appli,"<FONT SIZE=72 POINT-SIZE=72>Bonne année<BR>et bonne santé</FONT>",x,y,6,6));
  }
}
nodes.show();
window.nodes = nodes;

// --------------------------------------------------------------------------
window.go = go;
window.go(window.nodes);
</SCRIPT>
</body>
</html>






